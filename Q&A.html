<!-- -->
<!--Used this resource https://stackoverflow.com/questions/21998679/css-how-to-make-scrollable-list -->
<!-- Used https://stackoverflow.com/questions/4825295/javascript-onclick-to-get-the-id-of-the-clicked-button -->
<!-- Used this https://stackoverflow.com/questions/33178114/using-queryselectorall-to-change-the-style-property-of-multiple-elements -->
<!-- Used https://www.w3schools.com/tags/tag_input.asp and https://stackoverflow.com/questions/7381446/center-html-input-text-field-placeholder for the input tag -->
<!-- Used my code from https://github.com/KaveeshaW/it202-big-project/blob/master/index.html to get the question list working -->
<!-- Used this https://stackoverflow.com/questions/30022728/perform-action-when-clicking-html5-datalist-option for datalist actions -->
<!-- Used this for getting keys of dictionary https://stackoverflow.com/questions/10654992/how-can-i-get-a-collection-of-keys-in-a-javascript-dictionary  -->
<!DOCTYPE html>
<html>
<head>
    <title>Chemistry: Home</title>
    <link rel="stylesheet" href="CSS/questionAnswerLayout.css">
    <link rel="stylesheet" href="CSS/remindersLayout.css"> 

</head>
<body>
  
  <div class="container">
      <div class = "center">
          <input type="button" onclick="window.location.href='help.html'" id="helpButton" value="?">
          <p id="chemistryTitle">Chemistry</p>
          <p id="reminders">Q&A</p>
      </div>
      <div class="header">
          <nav>
              <ul>
                <li><a href="courses.html">Courses</a></li>
                <li><a href="calendar.html">Calendar</a></li>
                <li><a href="reminders.html">Reminders</a></li>
                <li><a href="messages.html">Messages</a></li>
                <li><a href="assistance.html">Assistance</a></li>
                <li><a href="settings.html">Settings</a></li>
              </ul>
          </nav>
      </div>
  </div>
      <div id="classQuestions">
        <input list = "questionList" type = "text" id = "search_question" name = "question" placeholder = "Search..." onclick = 'populateQuestionsInList()' oninput='putAnswerOnScreenIfClicked()'>
            <datalist id="questionList"> 
            </datalist>
        <nav id = "Q_and_A">
          <div>
            <p>Your Questions:</p>
          </div>
          
          <ul id="question_time">
              <li class="one_question"><button id = "button_0" class = "question_button" onClick = "show_answer(this.id)">What is water?</button></li>
              <li class="one_question"><button id = "button_1" class = "question_button" onClick = "show_answer(this.id)">What are the first 5 elements of the periodic table?</button></li>
              <li class="one_question"><button id = "button_2" class = "question_button" onClick = "show_answer(this.id)">What does specific heat mean?</button></li>
          </ul>
        </nav>
        <!-- <input type="button" onclick = goBackToFirstScreen(this) id="addQuestionButton" value="+">  -->
        <p id="yourQuestionOrAnswerParagraph">Your Question:</p>
        <p id="answer">Ask any question related to your class! Please be polite and respectful.</p>
        <input type="text" id="input_question" name="ask_a_question" placeholder = "Type Question...">
        <button id = "ask_your_question_button" onclick = "get_input()" disabled = true>Ask</button>
      </div>
  
      <div id="yourQuestions">
        <!-- <p id="yourQuestionOrAnswerParagraph">Your Question:</p>
        <p id="answer">Ask any question related to your class! Please be polite and respectful.</p>
        <input type="text" id="input_question" name="ask_a_question" placeholder = "Type Question...">
        <button id = "ask_your_question_button" onclick = "get_input()" disabled = true>Ask</button> -->
        <!-- <input type="text" id="input_answer" name="answer_a_question" placeholder = "Answer Question...">
        <button id = "reply_to_question_button" onclick = "get_input()" disabled = true>Respond</button> -->
      </div>
      

      <script type = "text/javascript">
        
        let newAnswerId = 3; // used whenever a new question is asked, the question will be added to the array, then update this 
        let newQuestion = true; 
        let questionLetterCount = 0;

        let questions = [
          "What is water?",
          "What are the first 5 elements of the periodic table?",
          "What is specific heat?"
        ]

        let answers = [
          "A substance composed of the chemical elements hydrogen and oxygen and existing in gaseous, liquid, and solid states",
          "Hydrogen, Helium, Lithium, Berylium, Boron",
          "The heat required to raise the temperature of the unit mass of a given substance by a given amount (usually one degree)"
        ]
        
        questionAndAnswer = {
          0: {"What is water?":  "A substance composed of the chemical elements hydrogen and oxygen and existing in gaseous, liquid, and solid states."},
          1: {"What are the first 5 elements of the periodic table?": "Hydrogen, Helium, Lithium, Berylium, Boron"},
          2: {"What does specific heat mean?": "The heat required to raise the temperature of the unit mass of a given substance by a given amount (usually one degree)."}
        }
        
        function show_answer(id_of_button) {
          resetButtons();
          let button_and_number = id_of_button.split("_"); 
          let whichQuestion = button_and_number[1]; 

          let answer = document.querySelector("#answer");
          answer.innerHTML = questionAndAnswer[whichQuestion][document.querySelector("#" + id_of_button).innerHTML];
          
          document.querySelector("#yourQuestionOrAnswerParagraph").innerHTML = "Answer";

          let button = document.querySelector("#" + id_of_button);
          button.style.backgroundColor = "rgb(195, 195, 195)";
        }

        function resetButtons() {
          document.querySelectorAll("button.question_button").forEach(questionButton => {
            questionButton.style.backgroundColor = "rgb(239, 239, 239)";
          }); 
        }

        function goBackToFirstScreen() {
          alert("will be implemented eventually");
        }

        function populateQuestionsInList() {
          // update questionlist if new question available
          if(newQuestion) {
            let questionList = document.querySelector("#questionList");
            let whichQuestion = 0;
            //for the option menu showing all of the different questions  
            for(const question of questions) {
              let specificQuestion = question;
              let option = document.createElement("option");
              option.textContent = specificQuestion;
              option.value = specificQuestion;
              questionList.appendChild(option);
              whichQuestion++;
            }
          }
           newQuestion = false;
        };
        
        function putAnswerOnScreenIfClicked() {
          let userInput = document.querySelector("#search_question").value;
          let whichQuestion = document.querySelector('#questionList').childNodes;
          //node indexing starts at one for some reason, the index in the array starts at 0
          for (let questionInNodes = 1; questionInNodes < Object.keys(questionAndAnswer).length + 1; questionInNodes++) {
            if (whichQuestion[questionInNodes].value == userInput) {
              let indexInArray = questionInNodes - 1;
              let button_id = "button_" + indexInArray;
              show_answer(button_id);
              document.querySelector("#search_question").value = "";
            }
          }
        }
        
        let question_input = document.querySelector("#input_question");
        question_input.addEventListener('input', checkInputValue);
        
        function checkInputValue(e) {
          let askQuestionButton = document.querySelector("#ask_your_question_button");
          console.log(e);
          if(e.data != null) {
            questionLetterCount++;
            askQuestionButton.disabled = false;
          }
          else if(e.inputType == "deleteContentBackward") {
            questionLetterCount--;
          }
          if(questionLetterCount == 0) {
            askQuestionButton.disabled = true;
          }
        }

        function get_input() {
          let askQuestionField = document.querySelector("#input_question");
          let question = askQuestionField.value;
          askQuestionField.value = "";

          let newQuestion = document.createElement("li");
          newQuestion.class = "one_question";

          let button = document.createElement("button");
          button.id = "button_" + newAnswerId;
          button.className = "question_button";
          button.innerHTML = question;
          button.style.backgroundColor = "rgb(239, 239, 239)";
          let obj = {};
          obj[question] = "not answered yet";
          questionAndAnswer[newAnswerId] = obj;
         // questionAndAnswer[newAnswerId] = {question : "not answered yet"};
          console.log(questionAndAnswer);
          newAnswerId++;

          newQuestion.appendChild(button);
          document.querySelector("#question_time").appendChild(newQuestion);
          let id = button.id;
          document.querySelector("#" + button.id).setAttribute('onclick', 'show_answer(id)');

          newQuestion = true;
        }
      
      </script>
</body>
</html>